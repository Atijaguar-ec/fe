<smart-tag [isOpen]="isOpen && !rawObjectData"
           [readOnly]="rawObjectData"
           [formControlInput]="originalFormControl"
           [viewOnly]="readOnly"
           (onDelete)="delete()">
  <tag-closed>
    <div *ngIf="contentObject" class="c-capitalize-first">
      <div class="tagitem-text-container">
        <span>{{ contentObject.code }} - {{ contentObject.label }}</span>
      </div>
    </div>
  </tag-closed>
  <tag-open>
    <subform-layout>
      <subform-form>
        <h5 class="sp-subform-title">{{ title }}</h5>

        <ng-container *ngIf="configItemType === 'facility-types'">
          <single-choice
                  label="Facility type"
                  i18n-label="@@valueChainDetail.section.facilityTypes.add.label"
                  [formControlInput]="configItemForm"
                  [codebookService]="facilityTypesCodebook"
                  [isInvalidChoice]="submitted && configItemForm.invalid"
                  [readonly]="readOnly"
                  (onChange)="setSelectedValue($event)">
            <ng-container *ngIf="submitted">
              <div *ngIf="configItemForm.errors as errors" class="sc-invalid-feedback">
                <div *ngIf="errors.required" i18n="@@valueChainDetail.section.facilityTypes.add.error">
                  Facility type is required
                </div>
              </div>
            </ng-container>

          </single-choice>
        </ng-container>

        <ng-container *ngIf="configItemType === 'measure-unit-types'">
          <single-choice
                  label="Measure unit type"
                  i18n-label="@@valueChainDetail.section.measureUnitTypes.add.label"
                  [formControlInput]="configItemForm"
                  [codebookService]="measureUnitTypesCodebook"
                  [isInvalidChoice]="submitted && configItemForm.invalid"
                  [readonly]="readOnly"
                  (onChange)="setSelectedValue($event)">
            <ng-container *ngIf="submitted">
              <div *ngIf="configItemForm.errors as errors" class="sc-invalid-feedback">
                <div *ngIf="errors.required" i18n="@@valueChainDetail.section.measureUnitTypes.add.error">
                  Measure unit type is required
                </div>
              </div>
            </ng-container>

          </single-choice>
        </ng-container>

        <ng-container *ngIf="configItemType === 'grade-abbreviation-types'">
          <single-choice
                  label="Grade abbreviation type"
                  i18n-label="@@valueChainDetail.section.gradeAbbreviations.add.label"
                  [formControlInput]="configItemForm"
                  [codebookService]="gradeAbbreviationTypesCodebook"
                  [isInvalidChoice]="submitted && configItemForm.invalid"
                  [readonly]="readOnly"
                  (onChange)="setSelectedValue($event)">
            <ng-container *ngIf="submitted">
              <div *ngIf="configItemForm.errors as errors" class="sc-invalid-feedback">
                <div *ngIf="errors.required" i18n="@@valueChainDetail.section.gradeAbbreviations.add.error">
                  Grade abbreviation type is required
                </div>
              </div>
            </ng-container>

          </single-choice>
        </ng-container>

      </subform-form>

      <subform-mini-buttons style="width: 100%;" class="d-flex justify-content-end">
        <mini-buttons
                (onSave)="save()"
                (onCancel)="cancel()"
                [error]="submitted && form.invalid"
                [cancelButtonOnly]="readOnly">
        </mini-buttons>
      </subform-mini-buttons>
    </subform-layout>
  </tag-open>
</smart-tag>
