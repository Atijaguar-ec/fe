<app-authorised-layout>
  <app-product-label-left-panel-content>
  </app-product-label-left-panel-content>

  <div class="main">

    <div class="main-inside-top content-element">
      <div class="d-flex justify-content-between content-element--row1">
        <div class="title-page content-element--title" i18n="@@productLabelStock.title.transactions">Transactions</div>
        <!-- <button class="btn btn-solid round btn-table-new content-element--btn" (click)="newTra()" i18n="@@productLabelStock.button.newPurchaseOrders">
          <span>+ Add order</span>
        </button> -->
      </div>

      <!-- <div class="af-form-wrapper"> -->
      <!-- </div> -->
      <div class="af-form-row af-form-row--nomargin">
        <!-- <div class="af-form-row" style="background-color: inherit;"> -->
        <div class="af-form-block--c8">
          <div class="af-form-element">
            <div class="af-row">
              <div class="af-c6">

                <single-choice *ngIf="facilityCodebook"
                  label="Input facility"
                  i18n-label="@@productLabelStockPurchaseOrdersModal.singleChoice.inputFacility"
                  [formControlInput]="transactionListingForm.get('inputFacility')"
                  [codebookService]="facilityCodebook"
                  style="min-width: 150px;">
                </single-choice>

              </div>
              <div class="af-c6">

                <single-choice *ngIf="facilityCodebook"
                  label="Output facility"
                  i18n-label="@@productLabelStockPurchaseOrdersModal.singleChoice.outputFacility"
                  [formControlInput]="transactionListingForm.get('outputFacility')"
                  [codebookService]="facilityCodebook"
                  style="min-width: 150px;">
                </single-choice>

              </div>
            </div>
            <div class="af-row">
              <div class="af-c6">

                <single-choice *ngIf="activeSemiProductsForProduct"
                  label="Semi-product"
                  i18n-label="@@productLabelStockPurchaseOrdersModal.singleChoice.semiProduct"
                  [formControlInput]="transactionListingForm.get('semiProduct')"
                  [codebookService]="activeSemiProductsForProduct"
                  style="min-width: 150px;">
                </single-choice>

              </div>
              <div class="af-c6">
                <div class="d-flex">
                  <app-datepicker
                    label="From"
                    i18n-label="@@productLabelStockProcessingOrderDetail.datepicker.date.from"
                    [form]="transactionListingForm.get('startDate')"
                    style="width: 130px; margin-right: 1rem;">
                  </app-datepicker>

                  <app-datepicker
                    label="To"
                    i18n-label="@@productLabelStockProcessingOrderDetail.datepicker.date.to"
                    [form]="transactionListingForm.get('endDate')"
                    style="width: 130px">
                  </app-datepicker>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- <single-choice *ngIf="facilityCodebook"
        label="Input facility"
        i18n-label="@@productLabelStockPurchaseOrdersModal.singleChoice.inputFacility"
        [formControlInput]="transactionListingForm.get('inputFacility')"
        [codebookService]="facilityCodebook"
        style="min-width: 150px;">
      </single-choice>

      <single-choice *ngIf="facilityCodebook"
        label="Output facility"
        i18n-label="@@productLabelStockPurchaseOrdersModal.singleChoice.outputFacility"
        [formControlInput]="transactionListingForm.get('outputFacility')"
        [codebookService]="facilityCodebook"
        style="min-width: 150px;">
      </single-choice>

      <single-choice *ngIf="activeSemiProductsForProduct"
        label="Semi-product"
        i18n-label="@@productLabelStockPurchaseOrdersModal.singleChoice.semiProduct"
        [formControlInput]="transactionListingForm.get('semiProduct')"
        [codebookService]="activeSemiProductsForProduct"
        style="min-width: 150px;">
      </single-choice>

      <div class="d-flex">
        <app-datepicker
          label="From"
          i18n-label="@@productLabelStockProcessingOrderDetail.datepicker.date.from"
          [form]="transactionListingForm.get('startDate')"
          style="width: 130px; margin-right: 1rem;">
        </app-datepicker>

        <app-datepicker
          label="To"
          i18n-label="@@productLabelStockProcessingOrderDetail.datepicker.date.to"
          [form]="transactionListingForm.get('endDate')"
          style="width: 130px">
        </app-datepicker>
      </div> -->
      <!-- [codebookService]="collectingFacilityForStockOrderCodebook" -->

      <div class="d-flex justify-content-between main-inside-top--row2">
        <div>
          <div class="sub-title-page content-element--subtitle" i18n="@@productLabelStock.subTitle.listOfTransactions">List of transactions</div>
          <div class="counting-page content-element--counting" i18n="@@productLabelStock.subTitle.showingTransactions">Showing {{showedPurchaseOrders}}/{{allPurchaseOrders}}</div>
        </div>

        <div class="d-flex align-items-top">
          <div class="d-flex align-items-center" style="margin-bottom: 1rem;" ngbDropdown placement="bottom-right" display="dynamic" container="body">

            <div *ngIf="openBalanceOnly" class="d-flex filter-text" style="margin-left: 0.75rem" i18n="@@productLabelStock.filter.openBalanceOnly.filter">Open balance
              <div style="margin-left: 0.5rem;" (click)="setOpenBalanceOnly(false)">
                <fa-icon style="cursor: pointer;" [icon]="faTimes" size="xs">
                </fa-icon>
              </div>
            </div>

            <!-- <div *ngIf="purchaseOrderOnly" class="d-flex filter-text" style="margin-left: 0.75rem" i18n="@@productLabelStock.filter.purchaseOrderOnly.filter">Purchase order only
              <div style="margin-left: 0.5rem;" (click)="setPurchaseOrdersOnly(false)">
                <fa-icon style="cursor: pointer;" [icon]="faTimes" size="xs">
                </fa-icon>
              </div>
            </div> -->

            <button ngbDropdownToggle class="btn btn-filter" style="margin-left: 1rem;" i18n-placeholder="@@productLabelStock.filter.placeholder">
              <div class="button-icon">
                <span class="button-icon-shape button-icon-shape--filter"></span>
              </div>
              <span i18n="@@list.button.filter" class="button-icon-label">Filter</span>
            </button>

            <div class="dropdown-menu" ngbDropdownMenu>
              <button *ngIf="!openBalanceOnly" ngbDropdownItem (click)="setOpenBalanceOnly(true)" i18n="@@productLabelStock.filter.openBalanceOnly.button">Open balance</button>
              <!-- <button *ngIf="!purchaseOrderOnly" ngbDropdownItem (click)="setPurchaseOrdersOnly(true)" i18n="@@productLabelStock.filter.purchaseOrderOnly.button">Purchase orders only</button> -->
            </div>

            <button class="af-actions-btn" [class.af-actions-btn--disabled]="selectedTransactions.length == 0" (click)="selectedTransactions.length> 0 && deleteSelectedTransactions()">
              <span class="af-actions-btn-label" i18n="@@productLabelStock.button.deleteTransactions">Delete transactions</span>
            </button>
          </div>

        </div>
      </div>

      <app-product-label-stock-transaction-list
        [reloadPingList$]="reloadDataPing$"
        (countAll)="onCountAllPO($event)"
        [sourceFacilityId$]="sourceFacilityId$"
        [targetFacilityId$]="targetFacilityId$"
        [semiProductId$]="semiProductId$"
        [startDate$]="startDate$"
        [endDate$]=endDate$
        [selectedTransactions]="selectedTransactions"
        (selectedIdsChanged)="selectedIdsChanged($event)"
        (showing)="onShowPO($event)">
      </app-product-label-stock-transaction-list>

      <div class="main-inside-top content-element">
        <div class="d-flex justify-content-between main-inside-top--row1">
          <div>
            <div class="sub-title-page content-element--subtitle"
              i18n="@@productLabelStock.title.processingOrders.processing transactions">List of processing transactions</div>
            <div class="counting-page content-element--counting" i18n="@@productLabelStock.title.processingOrders.orders.showing">Showing {{showedOrders}}/{{allOrders}}</div>
          </div>
        </div>

        <app-product-label-stock-processing-order-list
          [reloadPingList$]="reloadDataPing$"
          (countAll)="onCountAll($event, 'ORDER')"
          (showing)="onShow($event, 'ORDER')"
          [facilityId$]="selectedFacilityId$">
        </app-product-label-stock-processing-order-list>

      </div>

    </div>

  </div>
</app-authorised-layout>
