<div class="af-form-element position-relative outputs-bottom-spacing processing-section classification-section">
    
    <!-- HEADER: Selecci√≥n de semi-producto y instalaci√≥n -->
    <div class="af-row">
        <div class="af-c12 d-flex">
            <div class="flex-fill">
                <single-choice
                    label="Tipo de semi-producto"
                    i18n-label="@@productLabelStockProcessingOrderDetail.classification.semiProduct.label"
                    [formControlInput]="$any(tsoGroup.get('semiProduct'))"
                    [codebookService]="outputSemiProductsCodebook"
                    [clearable]="false"
                    style="min-width: 150px;"
                    [isInvalidChoice]="submitted && tsoGroup.get('semiProduct').invalid">
                    <ng-container *ngIf="submitted">
                        <div *ngIf="tsoGroup.get('semiProduct').errors as errors" class="sc-invalid-feedback"
                             i18n="@@productLabelStockProcessingOrderDetail.classification.semiProduct.error">
                            El semi-producto es requerido
                        </div>
                    </ng-container>
                </single-choice>
            </div>
            <div class="ml-4">
                <div class="delete-output-icon"
                     [class.disabled]="!canDelete"
                     (click)="onRemoveOutput()">
                    <fa-icon class="del-icon" [icon]="faTrashAlt"></fa-icon>
                </div>
            </div>
        </div>
    </div>

    <!-- FACILITY SELECTION -->
    <div class="af-row">
        <div class="af-c12">
            <single-choice
                *ngIf="tsoGroup.get('semiProduct').value"
                label="Instalaci√≥n"
                i18n-label="@@productLabelStockProcessingOrderDetail.classification.facility.label"
                [formControlInput]="$any(tsoGroup.get('facility'))"
                [codebookService]="getOutputFacilityCodebook()"
                [clearable]="false"
                style="min-width: 150px;"
                [isInvalidChoice]="submitted && tsoGroup.get('facility').invalid">
                <ng-container *ngIf="submitted">
                    <div *ngIf="tsoGroup.get('facility').errors as errors" class="sc-invalid-feedback"
                         i18n="@@productLabelStockProcessingOrderDetail.classification.facility.error">
                        La instalaci√≥n es requerida
                    </div>
                </ng-container>
            </single-choice>
        </div>
    </div>


    <!-- ü¶ê CUSTODIA: N√öMERO DE LOTE INTERNO (propagado desde entradas) -->
    <div class="af-row">
        <div class="af-c3">
            <textinput
                [form]="procActionLotPrefixControl"
                label="Prefijo"
                style="width: 100%"
                i18n-label="@@productLabelStockProcessingOrderDetail.classification.lotPrefix.label">
            </textinput>
        </div>
        <div class="af-c9">
            <textinput
                [form]="$any(tsoGroup.get('internalLotNumber'))"
                label="N√∫mero de Lote"
                style="width: 100%" 
                placeholder="Heredado de la entrada"
                i18n-label="@@productLabelStockProcessingOrderDetail.classification.internalLotNumber.label"
                i18n-placeholder="@@productLabelStockProcessingOrderDetail.classification.internalLotNumber.placeholder"
                [isInvalid]="submitted && tsoGroup.get('internalLotNumber').invalid">
                <ng-container *ngIf="submitted">
                    <div *ngIf="tsoGroup.get('internalLotNumber').errors as errors" class="sc-invalid-feedback">
                        <div *ngIf="errors.required" i18n="@@productLabelStockProcessingOrderDetail.classification.internalLotNumber.error">
                            El n√∫mero de lote es requerido
                        </div>
                    </div>
                </ng-container>
            </textinput>
        </div>
    </div>

    <!-- ü¶ê CUSTODIA: Campos de trazabilidad ocultos (se mantienen en el modelo pero no se muestran en UI)
         Campos eliminados de visualizaci√≥n: N¬∞ Gavetas, N¬∞ Bines, Gu√≠a Remisi√≥n
         Los valores se preservan internamente para trazabilidad -->
    <!-- OCULTO: Esta secci√≥n fue removida por solicitud del usuario -->

    <!-- OUTPUT QUANTITY -->
    <div class="af-row">
        <div class="af-c6">
            <textinput
                [form]="$any(tsoGroup.get('totalQuantity'))"
                [label]="outputQuantityLabel + ' ' + (tsoGroup.get('measureUnitType')?.value ? tsoGroup.get('measureUnitType').value.label : '-')"
                style="width: 100%"
                placeholder="Ingrese cantidad"
                i18n-placeholder="@@productLabelStockProcessingOrderDetail.classification.outputQuantity.placeholder"
                [isInvalid]="submitted && tsoGroup.get('totalQuantity').invalid">
                <ng-container *ngIf="submitted">
                    <div *ngIf="tsoGroup.get('totalQuantity').errors as errors" class="sc-invalid-feedback">
                        <div *ngIf="errors.required" i18n="@@productLabelStockProcessingOrderDetail.classification.outputQuantity.error.required">
                            La cantidad es requerida
                        </div>
                    </div>
                </ng-container>
            </textinput>
        </div>
    </div>

    <!-- CLASSIFICATION HEADER SECTION -->
    <div class="af-row mt-4">
        <div class="af-c12">
            <h3 class="classification-section-title" i18n="@@productLabelStockProcessingOrderDetail.classification.header.title">
                Detalles de Clasificaci√≥n
            </h3>
        </div>
    </div>

    <!-- ü¶ê SECCIONES DE LIQUIDACI√ìN - Un lote puede tener DOS liquidaciones -->
    <div class="af-row">
        <div class="af-c12">
            <div class="process-type-selector">
                <label class="form-label" i18n="@@productLabelStockProcessingOrderDetail.classification.processType.label">
                    Secciones de Liquidaci√≥n (puede activar ambas)
                </label>
                <div class="d-flex gap-3">
                    <!-- HEAD_ON Toggle -->
                    <div class="form-check form-switch flex-fill">
                        <input class="form-check-input" type="checkbox" role="switch" 
                               id="headOnToggle"
                               [checked]="activeProcessTypes.has('HEAD_ON')"
                               (change)="toggleProcessType('HEAD_ON')">
                        <label class="form-check-label" for="headOnToggle">
                            <strong>ü¶ê CON CABEZA (Entero)</strong>
                            <small class="d-block text-muted">Tallas: 20-30 a Pomada</small>
                        </label>
                    </div>
                    <!-- SHELL_ON Toggle -->
                    <div class="form-check form-switch flex-fill">
                        <input class="form-check-input" type="checkbox" role="switch" 
                               id="shellOnToggle"
                               [checked]="activeProcessTypes.has('SHELL_ON')"
                               (change)="toggleProcessType('SHELL_ON')">
                        <label class="form-check-label" for="shellOnToggle">
                            <strong>ü¶ê EN COLA (Shell-On)</strong>
                            <small class="d-block text-muted">Tallas: U-7 a 150+, con Clase A/B</small>
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- START AND END DATE -->
    <div class="af-row">
        <div class="af-c6">
            <app-datepicker
                label="Fecha de inicio"
                i18n-label="@@productLabelStockProcessingOrderDetail.classification.startTime.label"
                [form]="tsoGroup.get('classificationStartTime')"
                [invalid]="submitted && tsoGroup.get('classificationStartTime').invalid">
                <ng-container *ngIf="submitted">
                    <div *ngIf="tsoGroup.get('classificationStartTime').errors as errors" class="sc-invalid-feedback">
                        <div *ngIf="errors.required" i18n="@@productLabelStockProcessingOrderDetail.classification.startTime.error">
                            La fecha de inicio es requerida
                        </div>
                    </div>
                </ng-container>
            </app-datepicker>
        </div>
        <div class="af-c6">
            <app-datepicker
                label="Fecha de fin"
                i18n-label="@@productLabelStockProcessingOrderDetail.classification.endTime.label"
                [form]="tsoGroup.get('classificationEndTime')"
                [invalid]="submitted && tsoGroup.get('classificationEndTime').invalid">
                <ng-container *ngIf="submitted">
                    <div *ngIf="tsoGroup.get('classificationEndTime').errors as errors" class="sc-invalid-feedback">
                        <div *ngIf="errors.required" i18n="@@productLabelStockProcessingOrderDetail.classification.endTime.error">
                            La fecha de fin es requerida
                        </div>
                    </div>
                </ng-container>
            </app-datepicker>
        </div>
    </div>

    <!-- PRODUCTION ORDER, FREEZING TYPE, MACHINE -->
    <div class="af-row">
        <div class="af-c4">
            <textinput
                [form]="$any(tsoGroup.get('productionOrder'))"
                label="Orden de producci√≥n"
                placeholder="Ingrese orden de producci√≥n"
                i18n-label="@@productLabelStockProcessingOrderDetail.classification.productionOrder.label"
                i18n-placeholder="@@productLabelStockProcessingOrderDetail.classification.productionOrder.placeholder"
                [isInvalid]="submitted && tsoGroup.get('productionOrder').invalid">
                <ng-container *ngIf="submitted">
                    <div *ngIf="tsoGroup.get('productionOrder').errors as errors" class="sc-invalid-feedback">
                        <div *ngIf="errors.required" i18n="@@productLabelStockProcessingOrderDetail.classification.productionOrder.error">
                            La orden de producci√≥n es requerida
                        </div>
                    </div>
                </ng-container>
            </textinput>
        </div>
        <div class="af-c4">
            <textinput
                [form]="$any(tsoGroup.get('freezingType'))"
                label="Tipo de congelaci√≥n"
                placeholder="ej., IQF, Bloque"
                i18n-label="@@productLabelStockProcessingOrderDetail.classification.freezingType.label"
                i18n-placeholder="@@productLabelStockProcessingOrderDetail.classification.freezingType.placeholder"
                [isInvalid]="submitted && tsoGroup.get('freezingType').invalid">
                <ng-container *ngIf="submitted">
                    <div *ngIf="tsoGroup.get('freezingType').errors as errors" class="sc-invalid-feedback">
                        <div *ngIf="errors.required" i18n="@@productLabelStockProcessingOrderDetail.classification.freezingType.error">
                            El tipo de congelaci√≥n es requerido
                        </div>
                    </div>
                </ng-container>
            </textinput>
        </div>
        <div class="af-c4">
            <textinput
                [form]="$any(tsoGroup.get('machine'))"
                label="M√°quina"
                placeholder="Ingrese identificador de m√°quina"
                i18n-label="@@productLabelStockProcessingOrderDetail.classification.machine.label"
                i18n-placeholder="@@productLabelStockProcessingOrderDetail.classification.machine.placeholder"
                [isInvalid]="submitted && tsoGroup.get('machine').invalid">
                <ng-container *ngIf="submitted">
                    <div *ngIf="tsoGroup.get('machine').errors as errors" class="sc-invalid-feedback">
                        <div *ngIf="errors.required" i18n="@@productLabelStockProcessingOrderDetail.classification.machine.error">
                            La m√°quina es requerida
                        </div>
                    </div>
                </ng-container>
            </textinput>
        </div>
    </div>

    <!-- BRAND HEADER -->
    <div class="af-row">
        <div class="af-c6">
            <textinput
                [form]="$any(tsoGroup.get('brandHeader'))"
                label="Marca"
                placeholder="Ingrese nombre de marca"
                i18n-label="@@productLabelStockProcessingOrderDetail.classification.brandHeader.label"
                i18n-placeholder="@@productLabelStockProcessingOrderDetail.classification.brandHeader.placeholder"
                [isInvalid]="submitted && tsoGroup.get('brandHeader').invalid">
            </textinput>
        </div>
        <div class="af-c6">
            <textinput
                [form]="$any(tsoGroup.get('providerName'))"
                label="Proveedor"
                placeholder="Nombre del proveedor"
                i18n-label="@@productLabelStockProcessingOrderDetail.classification.providerName.label">
            </textinput>
        </div>
    </div>

    <!-- ü¶ê PESOS DE LIQUIDACI√ìN (Formato DUFER) -->
    <div class="af-row">
        <div class="af-c3">
            <textinput
                [form]="$any(tsoGroup.get('receivedWeight'))"
                label="Peso Recibido (lb)"
                type="number"
                placeholder="0.00"
                i18n-label="@@productLabelStockProcessingOrderDetail.classification.receivedWeight.label">
            </textinput>
        </div>
        <div class="af-c3">
            <textinput
                [form]="$any(tsoGroup.get('wasteWeight'))"
                label="Basura (lb)"
                type="number"
                placeholder="0.00"
                i18n-label="@@productLabelStockProcessingOrderDetail.classification.wasteWeight.label">
            </textinput>
        </div>
        <div class="af-c3">
            <textinput
                [form]="$any(tsoGroup.get('totalWeight'))"
                label="Peso Total (lb)"
                type="number"
                placeholder="0.00"
                i18n-label="@@productLabelStockProcessingOrderDetail.classification.totalWeight.label">
            </textinput>
        </div>
        <div class="af-c3">
            <textinput
                [form]="$any(tsoGroup.get('processedWeight'))"
                label="Peso Procesado (lb)"
                type="number"
                placeholder="0.00"
                i18n-label="@@productLabelStockProcessingOrderDetail.classification.processedWeight.label">
            </textinput>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- ü¶ê SECCI√ìN 1: LIQUIDACI√ìN CON CABEZA (HEAD_ON) - Camar√≥n Entero        -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="af-row mt-4" *ngIf="activeProcessTypes.has('HEAD_ON')">
        <div class="af-c12">
            <div class="classification-section-box head-on-section">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h4 class="classification-table-title">
                        ü¶ê LIQUIDACI√ìN CON CABEZA (Entero)
                        <small class="text-muted d-block">Tallas: 20-30 a Pomada</small>
                    </h4>
                    <button class="btn btn-solid round" type="button" (click)="addClassificationDetailForType('HEAD_ON')">
                        <fa-icon [icon]="faPlus"></fa-icon>
                        <span class="ml-2">Agregar talla</span>
                    </button>
                </div>

                <div class="classification-table">
                    <div class="classification-table-header">
                        <div class="classification-col col-size">Talla</div>
                        <div class="classification-col col-boxes">Cajas</div>
                        <div class="classification-col col-weight-box">Peso/Caja</div>
                        <div class="classification-col col-format">Formato</div>
                        <div class="classification-col col-total-weight">Peso Total</div>
                        <div class="classification-col col-pounds">Libras</div>
                        <div class="classification-col col-actions"></div>
                    </div>

                    <ng-container *ngFor="let detailGroup of classificationDetailsArray.controls; index as detailIndex">
                        <div *ngIf="detailGroup.get('processType')?.value === 'HEAD_ON'" class="classification-table-row">
                            <div class="classification-col col-size">
                                <select class="form-control" [formControl]="$any(detailGroup.get('size'))">
                                    <option value="" disabled selected>Talla</option>
                                    <option *ngFor="let size of wholeSizeCatalog" [value]="size.code">{{ size.label }}</option>
                                </select>
                            </div>
                            <div class="classification-col col-boxes">
                                <textinput [form]="$any(detailGroup.get('boxes'))" type="number" min="0" step="1" placeholder="0"></textinput>
                            </div>
                            <div class="classification-col col-weight-box">
                                <textinput [form]="$any(detailGroup.get('weightPerBox'))" type="number" min="0" step="0.01" placeholder="0.00"></textinput>
                            </div>
                            <div class="classification-col col-format">
                                <select class="form-control" [formControl]="$any(detailGroup.get('weightFormat'))">
                                    <option value="KG">KG</option>
                                    <option value="LB">LB</option>
                                </select>
                            </div>
                            <div class="classification-col col-total-weight">
                                <span class="calculated-value">{{ calculateTotalWeight(detailGroup) | number:'1.2-2' }}</span>
                            </div>
                            <div class="classification-col col-pounds">
                                <span class="calculated-value">{{ calculatePoundsPerSize(detailGroup) | number:'1.2-2' }}</span>
                            </div>
                            <div class="classification-col col-actions">
                                <div class="delete-row-icon" (click)="removeClassificationDetail(detailIndex)">
                                    <fa-icon class="del-icon" [icon]="faTrashAlt"></fa-icon>
                                </div>
                            </div>
                        </div>
                    </ng-container>

                    <!-- Totals HEAD_ON -->
                    <div class="classification-table-row classification-totals-row">
                        <div class="classification-col col-size"><strong>TOTAL ENTERO</strong></div>
                        <div class="classification-col col-boxes"><strong>{{ calculateTotalBoxesForType('HEAD_ON') }}</strong></div>
                        <div class="classification-col col-weight-box"></div>
                        <div class="classification-col col-format"></div>
                        <div class="classification-col col-total-weight"><strong>{{ calculateTotalWeightForType('HEAD_ON') | number:'1.2-2' }}</strong></div>
                        <div class="classification-col col-pounds"><strong>{{ calculateTotalPoundsForType('HEAD_ON') | number:'1.2-2' }}</strong></div>
                        <div class="classification-col col-actions"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- ü¶ê SECCI√ìN 2: LIQUIDACI√ìN EN COLA (SHELL_ON) - Camar√≥n Descabezado      -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="af-row mt-4" *ngIf="activeProcessTypes.has('SHELL_ON')">
        <div class="af-c12">
            <div class="classification-section-box shell-on-section">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h4 class="classification-table-title">
                        ü¶ê LIQUIDACI√ìN EN COLA (Shell-On)
                        <small class="text-muted d-block">Tallas: U-7 a 150+ | Con Clase A/B y Aspecto</small>
                    </h4>
                    <button class="btn btn-solid round" type="button" (click)="addClassificationDetailForType('SHELL_ON')">
                        <fa-icon [icon]="faPlus"></fa-icon>
                        <span class="ml-2">Agregar talla</span>
                    </button>
                </div>

                <div class="classification-table">
                    <div class="classification-table-header">
                        <div class="classification-col col-size">Talla</div>
                        <div class="classification-col col-presentation">Aspecto</div>
                        <div class="classification-col col-quality">Clase</div>
                        <div class="classification-col col-boxes">Cajas</div>
                        <div class="classification-col col-weight-box">Peso/Caja</div>
                        <div class="classification-col col-format">Formato</div>
                        <div class="classification-col col-total-weight">Peso Total</div>
                        <div class="classification-col col-pounds">Libras</div>
                        <div class="classification-col col-actions"></div>
                    </div>

                    <ng-container *ngFor="let detailGroup of classificationDetailsArray.controls; index as detailIndex">
                        <div *ngIf="detailGroup.get('processType')?.value === 'SHELL_ON'" class="classification-table-row">
                            <div class="classification-col col-size">
                                <select class="form-control" [formControl]="$any(detailGroup.get('size'))">
                                    <option value="" disabled selected>Talla</option>
                                    <option *ngFor="let size of tailSizeCatalog" [value]="size.code">{{ size.label }}</option>
                                </select>
                            </div>
                            <div class="classification-col col-presentation">
                                <select class="form-control" [formControl]="$any(detailGroup.get('presentationType'))">
                                    <option value="" disabled selected>Aspecto</option>
                                    <option *ngFor="let pres of presentationTypeCatalog" [value]="pres.code">{{ pres.label }}</option>
                                </select>
                            </div>
                            <div class="classification-col col-quality">
                                <select class="form-control" [formControl]="$any(detailGroup.get('qualityGrade'))">
                                    <option *ngFor="let grade of qualityGradeCatalog" [value]="grade.code">{{ grade.label }}</option>
                                </select>
                            </div>
                            <div class="classification-col col-boxes">
                                <textinput [form]="$any(detailGroup.get('boxes'))" type="number" min="0" step="1" placeholder="0"></textinput>
                            </div>
                            <div class="classification-col col-weight-box">
                                <textinput [form]="$any(detailGroup.get('weightPerBox'))" type="number" min="0" step="0.01" placeholder="0.00"></textinput>
                            </div>
                            <div class="classification-col col-format">
                                <select class="form-control" [formControl]="$any(detailGroup.get('weightFormat'))">
                                    <option value="KG">KG</option>
                                    <option value="LB">LB</option>
                                </select>
                            </div>
                            <div class="classification-col col-total-weight">
                                <span class="calculated-value">{{ calculateTotalWeight(detailGroup) | number:'1.2-2' }}</span>
                            </div>
                            <div class="classification-col col-pounds">
                                <span class="calculated-value">{{ calculatePoundsPerSize(detailGroup) | number:'1.2-2' }}</span>
                            </div>
                            <div class="classification-col col-actions">
                                <div class="delete-row-icon" (click)="removeClassificationDetail(detailIndex)">
                                    <fa-icon class="del-icon" [icon]="faTrashAlt"></fa-icon>
                                </div>
                            </div>
                        </div>
                    </ng-container>

                    <!-- Totals SHELL_ON -->
                    <div class="classification-table-row classification-totals-row">
                        <div class="classification-col col-size"><strong>TOTAL COLA</strong></div>
                        <div class="classification-col col-presentation"></div>
                        <div class="classification-col col-quality"></div>
                        <div class="classification-col col-boxes"><strong>{{ calculateTotalBoxesForType('SHELL_ON') }}</strong></div>
                        <div class="classification-col col-weight-box"></div>
                        <div class="classification-col col-format"></div>
                        <div class="classification-col col-total-weight"><strong>{{ calculateTotalWeightForType('SHELL_ON') | number:'1.2-2' }}</strong></div>
                        <div class="classification-col col-pounds"><strong>{{ calculateTotalPoundsForType('SHELL_ON') | number:'1.2-2' }}</strong></div>
                        <div class="classification-col col-actions"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Validation Messages -->
    <div class="af-row" *ngIf="submitted && classificationDetailsArray.length === 0">
        <div class="af-c12">
            <div class="sc-invalid-feedback mt-2">
                <span i18n="@@productLabelStockProcessingOrderDetail.classification.detailsRequired.error">
                    Se requiere al menos una clasificaci√≥n por talla. Active una secci√≥n arriba.
                </span>
            </div>
        </div>
    </div>

    <!-- ü¶ê EXPORTAR LIQUIDACIONES - Solo visible despu√©s de guardar -->
    <div class="af-row mt-4" *ngIf="tsoGroup.get('id')?.value">
        <div class="af-c12">
            <div class="d-flex justify-content-end gap-2">
                <button class="btn btn-outline-primary" 
                        type="button" 
                        [disabled]="exportingLiquidacion"
                        (click)="exportLiquidacionPesca()">
                    <span *ngIf="!exportingLiquidacion" i18n="@@productLabelStockProcessingOrderDetail.classification.exportLiquidacionPesca">Exportar Liquidaci√≥n de Pesca</span>
                    <span *ngIf="exportingLiquidacion">Exportando...</span>
                </button>
                <button class="btn btn-outline-success" 
                        type="button" 
                        [disabled]="exportingLiquidacion"
                        (click)="exportLiquidacionCompra()">
                    <span *ngIf="!exportingLiquidacion" i18n="@@productLabelStockProcessingOrderDetail.classification.exportLiquidacionCompra">Exportar Liquidaci√≥n de Compra</span>
                    <span *ngIf="exportingLiquidacion">Exportando...</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Disabled overlay when right side is not enabled -->
    <div *ngIf="!rightSideEnabled" class="disabled-section-overlay"></div>
</div>
